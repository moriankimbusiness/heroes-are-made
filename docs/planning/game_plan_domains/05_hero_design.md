# 히어로 기획

## 기본 규칙
- 히어로 최대 보유 수는 4명이다.
- 모험가 뽑기(전투 중 실시간 소환) 방식은 사용하지 않는다.
- 각 히어로는 종족(Race) + 클래스(Class) 조합을 가진다.
- 종족/클래스는 이후 확장 가능한 데이터 기반 구조를 전제로 한다.
- 각 히어로는 개별 체력을 가진다.
- 체력 0 시 Down 상태가 되며 타깃/공격/스킬 수행에서 제외된다.
- 선택 히어로 상태창에는 체력(현재/최대)을 이벤트 기반으로 표시한다.
- 피격 연출은 hurt 애니메이션 대신 적색 윤곽선+내부 플래시를 사용한다.
- 사망 시 death 애니메이션 재생 후 오브젝트는 씬에 유지한다.
- 히어로 월드 오브젝트 상단에는 체력바를 표시한다.

## 전투 히어로 인터페이스
- 히어로 좌클릭 선택 시 화면 하단 약 1/4에 HeroInterface를 표시한다.
- 컬럼 순서는 초상화/장비/스탯/장비 카드/리롤을 고정한다.
- 초상화는 선택 히어로 스프라이트를 실시간 미러링한다.
- 선택된 히어로는 월드에서 초록 윤곽선+반투명 채움으로 강조한다.
- 히어로 이름은 display_name 우선 정책을 사용한다.
- 장비 슬롯은 무기/방어구/신발 3칸만 사용한다.
- 아이템 타입 체계도 WEAPON/ARMOR/BOOTS 3분류로 단순화한다.
- 스탯 표시는 총합(버프) 형식이며, 버프 0일 때 괄호를 생략한다.
- 레벨 행은 Level, EXP 게이지, 현재/필요 수치를 함께 표시한다.
- 레벨/EXP는 전투 임시값으로 운용하고 런 저장 연동은 제외한다.
- 사망 히어로도 선택/정보 열람을 허용한다.
- 선택 상태인 동안 공격 범위 원형 표시를 유지하고 해제 시 숨긴다.
- 우클릭 이동 명령 시 월드 좌표에 타원형+▼ 이동 마커를 표시한다.
- 이동 마커는 최근 1개만 유지하며, ▼ 화살표만 바운스 후 짧게 페이드아웃한다.
- 장비 카드 상점은 타입별 3장(무기/방어구/신발)을 동시에 제시한다.
- 카드 호버 시 1.3배 시각 확대를 사용한다.
- 리롤은 무료 5회 후 유료로 전환한다.
- 유료 리롤 비용은 10, 20, 30... 선형 증가하며 전투 재진입 시 초기화한다.
- 카드 구매/리롤은 버튼 이벤트 기반으로 처리한다.

## 편성/합류 규칙
- 시작 모험단은 3명으로 고정한다.
- 런 시작 전 편성 단계에서 초기 모험단을 확정한다(최대 4명).
- 런 진행 중 신규 합류는 월드 이벤트/보상 노드로만 발생한다.

## 이동/전투 운영 규칙
- 방어 기준점은 코어 중심으로 설정한다.
- 전장은 32x32 타일맵을 기준으로 운영한다.
- 이동 가능 영역은 바닥 타일이며, 막힘 타일과 코어 3x3 점유 타일은 이동 불가다.
- 조작 방식은 좌클릭 선택 + 우클릭 이동 명령이다.
- 이동 명령은 선택된 히어로 1명에게만 적용한다.
- 이동 중에는 walk 애니메이션 상태를 유지한다.
- 이동 중에는 자동공격을 보류하고, 이동 종료 후 자동공격으로 복귀한다.
- 우클릭 시 목표 좌표는 클릭 타일 중심으로 스냅한다.
- 이동은 타일 A* 경로 계산 후 경로 포인트 스텝 이동으로 처리한다.
- 도착 허용 오차(move_stop_distance)는 1px를 기준으로 운용한다.
- 경로 데이터가 유효하지 않으면 즉시 정지하고 현재 위치를 유지한다.

## 이동 판정 규칙
- 우회 대상은 정적 장애물(막힘 타일, 코어 3x3 점유 타일)로 제한한다.
- 동적 장애물(적/다른 히어로) 회피는 현재 범위에서 제외한다.
- 경로 계산/스텝 적용은 이동 명령 활성 시에만 수행한다.

## 사거리 규칙
- 히어로 선택 시 HeroInterface를 표시하고, 실제 공격 사거리 타일 사각형(NxN)은 `사거리` 라벨 hover 중에만 표시한다.
- 클래스별 기본 타일 사거리는 전사 4x4, 궁수 5x5, 마법사 5x5, 암살자 3x3이다.
- 중심 타일 정렬을 위해 짝수 범위는 내부 판정에서 홀수로 보정한다(전사 4x4 → 5x5).
- 공격 대상 판정은 타일 좌표 포함 여부 기반으로 처리한다.
- 사거리 오버레이는 전용 드로우 노드(`RangeOverlayDraw`)에서 셀 단위 `무채색 반투명 채움 + 흰색 격자/윤곽선`으로 직접 렌더한다.
- 격자/윤곽선은 1px 두께, 안티앨리어싱 없이 렌더한다.
- 히어로가 점유한 중심 타일은 사거리 채움에서 제외한다.
- 오버레이는 `GroundTiles` 바로 위에서 렌더하고, 장식/오브젝트 레이어 아래로 유지한다.
